From 8a5cb2810139a51bbddadf950f8a2087232e533c Mon Sep 17 00:00:00 2001
From: Patrick McCarty <patrick.mccarty@intel.com>
Date: Wed, 11 Jul 2018 20:44:36 -0700
Subject: [PATCH 1/4] Set EUID instead of loginuid for swdb history

The getloginuid() function tries to read from /proc/self/loginuid, but
this file never exists on Clear Linux. When the file does not exist,
None is returned, but the libdnf C++ API expects an unsigned integer.

Simply pass the effective UID here instead of loginuid.

Signed-off-by: Patrick McCarty <patrick.mccarty@intel.com>
---
 dnf/db/history.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/dnf/db/history.py b/dnf/db/history.py
index dc9c53b..7e8c143 100644
--- a/dnf/db/history.py
+++ b/dnf/db/history.py
@@ -453,7 +453,7 @@ class SwdbInterface(object):
             int(calendar.timegm(time.gmtime())),
             str(rpmdb_version),
             cmdline or "",
-            int(misc.getloginuid())
+            os.geteuid()
             )
         self.swdb.setReleasever(self.releasever)
         self._tid = tid
-- 
2.20.1

